<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>Motivation</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1671.4">
  <style type="text/css">
    p.p2 {margin: 0.0px 0.0px 13.0px 0.0px; line-height: 20.0px; font: 13.0px Helvetica; color: #000000; -webkit-text-stroke: #000000}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 20.0px; font: 12.0px Monaco; color: #000000; -webkit-text-stroke: #000000; background-color: #f6f6f6}
    span.s1 {font-kerning: none}
    span.s2 {font: 12.0px Monaco; font-kerning: none}
  </style>
</head>
<body>
<h1 style="margin: 0.0px 0.0px 19.2px 0.0px; line-height: 20.0px; font: 28.6px Helvetica; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>Motivation</b></span></h1>
<p class="p2"><span class="s1">The </span><span class="s2">faintr</span><span class="s1"> package provides convenience function for the evaluation of a model fit, obtained with the </span><span class="s2">brms</span><span class="s1"> package, for a Bayesian regression model for data from a factorial design. If the original model fit used (default) dummy coding of factors, the </span><span class="s2">faintr</span><span class="s1"> package allows extraction of many more meaningful comparisons. For example, it is possible to directly compare the difference between cells which are not comparable by dummy coding, and it is also possible to compare means in sets of cells, so as to recover the outcomes of deviance coding.</span></p>
<h1 style="margin: 0.0px 0.0px 19.2px 0.0px; line-height: 20.0px; font: 28.6px Helvetica; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>Installation</b></span></h1>
<p class="p2"><span class="s1">Install the </span><span class="s2">faintr</span><span class="s1"> package with </span><span class="s2">devtools</span><span class="s1"> from GitHub:</span></p>
<p class="p3"><span class="s1">devtools::install_github('michael-franke/bayes_mixed_regression_tutorial/faintr',<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">                         </span>build_vignettes = TRUE)</span></p>
<p class="p3"><span class="s1">library(faintr)</span></p>
<h1 style="margin: 0.0px 0.0px 19.2px 0.0px; line-height: 20.0px; font: 28.6px Helvetica; color: #000000; -webkit-text-stroke: #000000"><span class="s1"><b>Example</b></span></h1>
<p class="p2"><span class="s1">Consider a data set on pitch frequency in the speech of female and male speakers in polite and informal contexts.</span></p>
<p class="p3"><span class="s1">library(tidyverse)</span></p>
<p class="p3"><span class="s1">politedata = read_csv('https://raw.githubusercontent.com/michael-franke/bayes_mixed_regression_tutorial/master/code/politeness_data.csv')<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">head(politedata)</span></p>
<p class="p3"><span class="s1">## # A tibble: 6 x 5</span></p>
<p class="p3"><span class="s1">## <span class="Apple-converted-space">  </span>subject gender sentence context pitch</span></p>
<p class="p3"><span class="s1">## <span class="Apple-converted-space">  </span>&lt;chr&gt; <span class="Apple-converted-space">  </span>&lt;chr&gt;<span class="Apple-converted-space">  </span>&lt;chr&gt;<span class="Apple-converted-space">    </span>&lt;chr&gt; <span class="Apple-converted-space">  </span>&lt;dbl&gt;</span></p>
<p class="p3"><span class="s1">## 1 F1<span class="Apple-converted-space">      </span>F<span class="Apple-converted-space">      </span>S1 <span class="Apple-converted-space">      </span>pol<span class="Apple-converted-space">      </span>213.</span></p>
<p class="p3"><span class="s1">## 2 F1<span class="Apple-converted-space">      </span>F<span class="Apple-converted-space">      </span>S1 <span class="Apple-converted-space">      </span>inf<span class="Apple-converted-space">      </span>204.</span></p>
<p class="p3"><span class="s1">## 3 F1<span class="Apple-converted-space">      </span>F<span class="Apple-converted-space">      </span>S2 <span class="Apple-converted-space">      </span>pol<span class="Apple-converted-space">      </span>285.</span></p>
<p class="p3"><span class="s1">## 4 F1<span class="Apple-converted-space">      </span>F<span class="Apple-converted-space">      </span>S2 <span class="Apple-converted-space">      </span>inf<span class="Apple-converted-space">      </span>260.</span></p>
<p class="p3"><span class="s1">## 5 F1<span class="Apple-converted-space">      </span>F<span class="Apple-converted-space">      </span>S3 <span class="Apple-converted-space">      </span>pol<span class="Apple-converted-space">      </span>204.</span></p>
<p class="p3"><span class="s1">## 6 F1<span class="Apple-converted-space">      </span>F<span class="Apple-converted-space">      </span>S3 <span class="Apple-converted-space">      </span>inf<span class="Apple-converted-space">      </span>287.</span></p>
<p class="p2"><span class="s1">The cell means of this data set are:</span></p>
<p class="p3"><span class="s1">politedata %&gt;% group_by(gender, context) %&gt;% summarize(mean_pitch = mean(pitch))</span></p>
<p class="p3"><span class="s1">## # A tibble: 4 x 3</span></p>
<p class="p3"><span class="s1">## # Groups: <span class="Apple-converted-space">  </span>gender [2]</span></p>
<p class="p3"><span class="s1">## <span class="Apple-converted-space">  </span>gender context mean_pitch</span></p>
<p class="p3"><span class="s1">## <span class="Apple-converted-space">  </span>&lt;chr&gt;<span class="Apple-converted-space">  </span>&lt;chr&gt;<span class="Apple-converted-space">        </span>&lt;dbl&gt;</span></p>
<p class="p3"><span class="s1">## 1 F<span class="Apple-converted-space">      </span>inf <span class="Apple-converted-space">          </span>261.</span></p>
<p class="p3"><span class="s1">## 2 F<span class="Apple-converted-space">      </span>pol <span class="Apple-converted-space">          </span>233.</span></p>
<p class="p3"><span class="s1">## 3 M<span class="Apple-converted-space">      </span>inf <span class="Apple-converted-space">          </span>144.</span></p>
<p class="p3"><span class="s1">## 4 M<span class="Apple-converted-space">      </span>pol <span class="Apple-converted-space">          </span>133.</span></p>
<p class="p2"><span class="s1">A Bayesian regression model for a factorial design with by-subject and by-item random intercepts can be obtained with the </span><span class="s2">brms</span><span class="s1"> package as follows:</span></p>
<p class="p3"><span class="s1">library(brms)</span></p>
<p class="p3"><span class="s1">m_dummy = brm(pitch ~ gender * context + (1 | subject + sentence), politedata)</span></p>
<p class="p2"><span class="s1">The </span><span class="s2">brm</span><span class="s1"> function uses dummy coding per default. Look at the estimated coefficients:</span></p>
<p class="p3"><span class="s1">fixef(m_dummy)</span></p>
<p class="p3"><span class="s1">##<span class="Apple-converted-space">                      </span>Estimate Est.Error<span class="Apple-converted-space">        </span>Q2.5 <span class="Apple-converted-space">    </span>Q97.5</span></p>
<p class="p3"><span class="s1">## Intercept <span class="Apple-converted-space">          </span>260.55672 22.894586<span class="Apple-converted-space">  </span>212.747198 306.55812</span></p>
<p class="p3"><span class="s1">## genderM<span class="Apple-converted-space">            </span>-116.65491 29.789504 -177.970877 -55.97815</span></p>
<p class="p3"><span class="s1">## contextpol<span class="Apple-converted-space">          </span>-27.44564<span class="Apple-converted-space">  </span>7.865963<span class="Apple-converted-space">  </span>-42.595914 -12.26362</span></p>
<p class="p3"><span class="s1">## genderM:contextpol <span class="Apple-converted-space">  </span>15.80439 11.350807 <span class="Apple-converted-space">  </span>-5.893805<span class="Apple-converted-space">  </span>38.33587</span></p>
<p class="p2"><span class="s1">The reference cell is where </span><span class="s2">gender:F</span><span class="s1"> and </span><span class="s2">context:inf</span><span class="s1">, so female speakers in informal contexts. The estimated mean for the cell with data from male speakers in informal contexts is retrievable by adding the estimated coefficient </span><span class="s2">genderM</span><span class="s1"> in the output above from the estimated Intercept.</span></p>
<p class="p2"><span class="s1">The </span><span class="s2">faintr</span><span class="s1"> package provides convenience functions to compare different (groups of) cells to each other, based on a model fit like the above. Although the fit of the regression model uses a particular reference cell for dummy-coding, other contrasts of relevance can be retrieved from the posterior samples. For example, if we want to compare two cell diagonally, say, male speakers in informal contexts against female speakers in polite contexts, we can do this:</span></p>
<p class="p3"><span class="s1">compare_groups(</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>model = m_dummy,<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>higher = list(gender = "F", context = "pol"),</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>lower = list(gender = "M", context = "inf")</span></p>
<p class="p3"><span class="s1">)</span></p>
<p class="p3"><span class="s1">## Outcome of comparing groups:</span></p>
<p class="p3"><span class="s1">##<span class="Apple-converted-space">  </span>* higher:<span class="Apple-converted-space">  </span>gender:F context:pol<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">##<span class="Apple-converted-space">  </span>* lower: <span class="Apple-converted-space">  </span>gender:M context:inf<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">## Mean 'higher - lower':<span class="Apple-converted-space">  </span>89.21<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">## 95% CI: [ 25.13 ; 148.5 ]</span></p>
<p class="p3"><span class="s1">## P('higher - lower' &gt; 0):<span class="Apple-converted-space">  </span>0.9952</span></p>
<p class="p2"><span class="s1">We can also compare the effect of gender female against the grand mean, to retrieve the information normally obtained by deviance coding:</span></p>
<p class="p3"><span class="s1">compare_groups(</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>model = m_dummy,<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>higher = list(gender = "F"),</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>lower = list()</span></p>
<p class="p3"><span class="s1">)</span></p>
<p class="p3"><span class="s1">## Outcome of comparing groups:</span></p>
<p class="p3"><span class="s1">##<span class="Apple-converted-space">  </span>* higher:<span class="Apple-converted-space">  </span>gender:F<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">##<span class="Apple-converted-space">  </span>* lower: <span class="Apple-converted-space">  </span>grand mean<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">## Mean 'higher - lower':<span class="Apple-converted-space">  </span>54.38<span class="Apple-converted-space"> </span></span></p>
<p class="p3"><span class="s1">## 95% CI: [ 25.1 ; 85.1 ]</span></p>
<p class="p3"><span class="s1">## P('higher - lower' &gt; 0):<span class="Apple-converted-space">  </span>0.9995</span></p>
</body>
</html>
